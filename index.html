<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BKI Cloud | PT Bangga Karya Indonesia</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="h-screen flex flex-col bg-black text-white overflow-hidden">

    <nav class="p-4 border-b border-white/10 flex justify-between items-center bg-zinc-900">
        <div class="flex items-center gap-2">
            <div class="bg-white text-black px-2 py-1 rounded font-bold italic">BKI</div>
            <span class="font-bold">CLOUD DEPLOYER</span>
        </div>
        <button onclick="terbitkan()" id="btn" class="bg-blue-600 px-6 py-2 rounded-lg font-bold hover:bg-blue-500 transition-all">TERBITKAN</button>
    </nav>

    <main class="flex-1 flex flex-col md:flex-row p-4 gap-4 overflow-hidden">
        <textarea id="inputKode" class="flex-1 bg-zinc-950 border border-white/10 rounded-xl p-4 text-blue-400 font-mono text-sm outline-none" placeholder="Tempel kode HTML Bapak di sini..."></textarea>
        <iframe id="preview" class="flex-1 bg-white rounded-xl shadow-2xl"></iframe>
    </main>

    <div id="modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-6 bg-black/90 backdrop-blur-sm">
        <div class="bg-zinc-900 w-full max-w-md rounded-3xl p-8 text-center border border-white/10 shadow-2xl">
            <h2 class="text-2xl font-bold mb-4 text-green-500">âœ… Website Siap!</h2>
            <p class="text-white/60 text-sm mb-6">Salin link di bawah ini. Jika terlalu panjang, gunakan situs <b>bit.ly</b> untuk memperpendeknya agar tidak error.</p>
            
            <textarea id="linkHasil" readonly class="w-full bg-black border border-white/20 rounded-xl p-4 text-blue-400 text-xs mb-6 h-24 outline-none"></textarea>
            
            <div class="flex flex-col gap-3">
                <button onclick="copyKeClipboard()" class="w-full py-4 bg-white text-black rounded-xl font-bold">SALIN LINK</button>
                <button onclick="tutupModal()" class="w-full py-4 bg-white/5 rounded-xl text-sm">TUTUP</button>
            </div>
        </div>
    </div>

    <script>
        const input = document.getElementById('inputKode');
        const view = document.getElementById('preview');

        // Live Preview
        input.addEventListener('input', () => {
            const doc = view.contentWindow.document;
            doc.open(); doc.write(input.value); doc.close();
        });

        function terbitkan() {
            const kode = input.value.trim();
            if(!kode) return alert("Kodenya diisi dulu Pak Bos!");

            // Enkripsi Kode
            const encoded = btoa(encodeURIComponent(kode));
            // Gunakan format link yang lebih aman untuk Netlify
            const finalUrl = window.location.origin + "/?v=" + encoded;

            document.getElementById('linkHasil').value = finalUrl;
            document.getElementById('modal').classList.remove('hidden');
        }

        function copyKeClipboard() {
            const copyText = document.getElementById("linkHasil");
            copyText.select();
            document.execCommand("copy");
            alert("Link Berhasil Disalin! Silakan perpendek di Bitly atau langsung kirim.");
        }

        function tutupModal() {
            document.getElementById('modal').classList.add('hidden');
        }

        // Jalankan website jika ada data di URL
        window.onload = () => {
            const p = new URLSearchParams(window.location.search);
            if(p.has('v')) {
                try {
                    const h = decodeURIComponent(atob(p.get('v')));
                    document.open(); document.write(h); document.close();
                } catch(e) {
                    document.body.innerHTML = "<h1 style='color:white; text-align:center;'>Maaf Pak, Data terlalu besar untuk link gratisan. Kurangi ukuran kodenya sedikit.</h1>";
                }
            } else {
                input.value = "<h1>Selamat Datang di BKI Cloud</h1><p>Edit kode ini lalu klik Terbitkan.</p>";
                const doc = view.contentWindow.document;
                doc.open(); doc.write(input.value); doc.close();
            }
        }
    </script>
</body>
</html>
